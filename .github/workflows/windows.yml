name: go-windows

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

permissions:
  contents: read

jobs:
  test:
    runs-on: windows-latest

    steps:
      - uses: actions/checkout@v5
      - uses: cloudengio/.github/.github/actions/go@main
      - uses: cloudengio/.github/.github/actions/pebble@main
      - uses: cloudengio/.github/.github/actions/chrome@main
        id: setup-chrome
      - uses: cloudengio/.github/.github/actions/mkcert@main

      - name: test
        env:
          CHROME_BIN_PATH: ${{ steps.setup-chrome.outputs.chrome-path }}
          CHROME_USER_DATA_DIR: ${{ steps.setup-chrome.outputs.chrome-user-data-dir }}
        run: |
          cd webapp/devtest/chromedputil
          go test -v -failfast --covermode=atomic --vet=off -race  -run=TestRunLoggingListenerEvaluate .

  #test:
  #  uses: cloudengio/.github/.github/workflows/go-test-multimod.yml@main
  #  with:
  #    os-version: windows-latest
  #    go-versions: |
  #      [ "1.25.x" ]
